name: honeypot-test-environment

networks:
  honeypot_network:
    driver: bridge
    ipam:
      config:
        - subnet: 10.0.0.0/16

services:
  smart-camera:
    build: 
      context: ./smart-camera
      dockerfile: Dockerfile
    container_name: smart-camera
    networks:
      honeypot_network:
        ipv4_address: 10.0.0.2
    ports:
      - "8080:80"
    restart: unless-stopped

  iot-gateway:
    build:
      context: ./gateway-config
      dockerfile: Dockerfile
    container_name: iot-gateway
    networks:
      honeypot_network:
        ipv4_address: 10.0.0.3
    ports:
      - "8081:80"
    restart: unless-stopped

  smart-thermostat:
    build:
      context: ./smart-thermostat
      dockerfile: Dockerfile
    container_name: smart-thermostat
    networks:
      honeypot_network:
        ipv4_address: 10.0.0.5
    ports:
      - "8082:80"
    restart: unless-stopped

  analysis-system:
    build:
      context: ../..
      dockerfile: test_environment/docker/analysis/Dockerfile
    container_name: analysis-system
    networks:
      honeypot_network:
        ipv4_address: 10.0.0.4
    volumes:
      - ../../src:/app/src
      - ../../test_environment:/app/test_environment
    depends_on:
      - smart-camera
      - iot-gateway
      - smart-thermostat